pbgtest(model.twoway)                         #Breusch-Godfrey/Woolridge test for serial autocorrelation, failed
data<-plm.data(modelvars, index = c("scode", "year"))
require(tseries)
adf.test(modelvars$spending.wb, k=2)                 #passes, p=0 means it is stationary
# Testing for homoskedasticity of errors
bptest(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(trade.wb):lag(mdi) +
lag(polity2) +
lag(trade.wb):lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(spending.wb) +
lag(spending.wb, 2),
data=df,
studentize=F)                #BP test for homoscedasticity, p=0 means heteroskedastic
# Two-way Fixed Effects with Democracy Interaction
model.dem.twoway<-plm(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb,2) +
lag(trade.wb):lag(mdi) +
lag(trade.wb):lag(polity2),
data=mainvars.bal,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.dem.twoway)
coeftest(model.dem.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
model.fd.twoway<-plm(diff(spending.wb) ~
lag(trade.wb) +
lag(diff(trade.wb)) +
lag(mdi) +
lag(diff(mdi)) +
lag(polity2) +
lag(diff(polity2)) +
lag(diff(gdpcap.wb)) +
lag(diff(dependency.wb)) +
lag(spending.wb) +
lag(spending.wb,3) +
lag(diff(spending.wb)) +
lag(trade.wb):lag(mdi) +
lag(diff(trade.wb)):lag(diff(mdi)) +
lag(trade.wb):lag(polity2) +
lag(diff(trade.wb)):lag(diff(polity2)),
data=mainvars.bal,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.fd.twoway)
coeftest(model.fd.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
stargazer(model.twoway, model.dem.twoway, model.fd.twoway,
title="Table 1 Re-Estimated on Balanced Panel (1961-1999)",
covariate.labels=c("$Trade_{t-1}$",
"$\\Delta Trade_{t-1}$",
"$MDI_{t-1}$",
"$\\Delta MDI_{t-1}$",
"$Democracy_{t-1}$",
"$GDPPerCapita_{t-1}$",
"$Dependency_{t-1}$",
"$LandArea_{t-1}$",
"$\\Delta Democracy_{t-1}$",
"$\\Delta GDPPerCapita_{t-1}$",
"$\\Delta Dependency_{t-1}$",
"$Spending_{t-1}$",
"$Spending_{t-2}$",
"$Spending_{t-3}$",
"$\\Delta Spending_{t-1}$",
"$Trade_{t-1}$ * $MDI_{t-1}$",
"$\\Delta Trade_{t-1}$ * $\\Delta MDI_{t-1}$",
"$Trade_{t-1}$ * $Democracy_{t-1}$",
"$\\Delta Trade_{t-1}$ * $\\Delta Democracy_{t-1}$"),
dep.var.labels.include=FALSE,
digits = 2,
style = "ajps",
omit.stat=c("f"),
font.size = "footnotesize",
out="article/balanced_models_table.tex")
###################################################################
### Guard against Nickell Bias by using only countries running the whole time period
#####################################################################
main.comp<-mainvars[complete.cases(mainvars),]
obs.all <- tabulate(main.comp$scode) # incl lots of zeros for unused gvkey
num.obs <- tabulate(obs.all)
mode.num.obs <- which(num.obs == max(num.obs))
nt.bal <- num.obs[mode.num.obs] * mode.num.obs
pot.obs <- which(obs.all == mode.num.obs)
# create new df w/o units that don't run the whole sample period
pot.obs.index <- which(main.comp$scode %in% pot.obs)
mainvars.bal <- main.comp[pot.obs.index, ]
# Two-way Fixed Effects
model.twoway<-plm(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb,2) +
lag(trade.wb):lag(mdi),
index = c("scode","year"),
model="within",
effect="twoway",
data=mainvars.bal)
summary(model.twoway)
coeftest(model.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good!
fixef(model.twoway)
plmtest(model.twoway, type=c("bp"))   # Breusch-Pagan Multiplier Test; reject null of no significant differences between panels
plmtest(model.twoway, c("time"), type=("bp")) # B-P L-M test for time effects; accept that we need time effects
pbgtest(model.twoway)                         #Breusch-Godfrey/Woolridge test for serial autocorrelation, failed
data<-plm.data(modelvars, index = c("scode", "year"))
require(tseries)
adf.test(modelvars$spending.wb, k=2)                 #passes, p=0 means it is stationary
# Testing for homoskedasticity of errors
bptest(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(trade.wb):lag(mdi) +
lag(polity2) +
lag(trade.wb):lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(spending.wb) +
lag(spending.wb, 2),
data=df,
studentize=F)                #BP test for homoscedasticity, p=0 means heteroskedastic
# Two-way Fixed Effects with Democracy Interaction
model.dem.twoway<-plm(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb,2) +
lag(trade.wb):lag(mdi) +
lag(trade.wb):lag(polity2),
data=mainvars.bal,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.dem.twoway)
coeftest(model.dem.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
model.fd.twoway<-plm(diff(spending.wb) ~
lag(trade.wb) +
lag(diff(trade.wb)) +
lag(mdi) +
lag(diff(mdi)) +
lag(polity2) +
lag(diff(polity2)) +
lag(diff(gdpcap.wb)) +
lag(diff(dependency.wb)) +
lag(spending.wb) +
lag(spending.wb,3) +
lag(diff(spending.wb)) +
lag(trade.wb):lag(mdi) +
lag(diff(trade.wb)):lag(diff(mdi)) +
lag(trade.wb):lag(polity2) +
lag(diff(trade.wb)):lag(diff(polity2)),
data=mainvars.bal,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.fd.twoway)
coeftest(model.fd.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
stargazer(model.twoway, model.dem.twoway, model.fd.twoway,
title="Table 1 Re-Estimated on Balanced Panel (1961-1999)",
covariate.labels=c("$Trade_{it-1}$",
"$\\Delta Trade_{it-1}$",
"$MDI_{it-1}$",
"$\\Delta MDI_{it-1}$",
"$Democracy_{it-1}$",
"$GDPPerCapita_{it-1}$",
"$Dependency_{it-1}$",
"$LandArea_{it-1}$",
"$\\Delta Democracy_{it-1}$",
"$\\Delta GDPPerCapita_{it-1}$",
"$\\Delta Dependency_{it-1}$",
"$Spending_{it-1}$",
"$Spending_{it-2}$",
"$Spending_{it-3}$",
"$\\Delta Spending_{it-1}$",
"$Trade_{t-1}$ * $MDI_{it-1}$",
"$\\Delta Trade_{it-1}$ * $\\Delta MDI_{it-1}$",
"$Trade_{it-1}$ * $Democracy_{it-1}$",
"$\\Delta Trade_{it-1}$ * $\\Delta Democracy_{it-1}$"),
dep.var.labels.include=FALSE,
digits = 2,
style = "ajps",
omit.stat=c("f"),
font.size = "footnotesize",
out="article/balanced_models_table.tex")
###################################################################
### Guard against Nickell Bias by using only countries running the whole time period
#####################################################################
main.comp<-mainvars[complete.cases(mainvars),]
obs.all <- tabulate(main.comp$scode) # incl lots of zeros for unused gvkey
num.obs <- tabulate(obs.all)
mode.num.obs <- which(num.obs == max(num.obs))
nt.bal <- num.obs[mode.num.obs] * mode.num.obs
pot.obs <- which(obs.all == mode.num.obs)
# create new df w/o units that don't run the whole sample period
pot.obs.index <- which(main.comp$scode %in% pot.obs)
mainvars.bal <- main.comp[pot.obs.index, ]
# Two-way Fixed Effects
model.twoway<-plm(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb,2) +
lag(trade.wb):lag(mdi),
index = c("scode","year"),
model="within",
effect="twoway",
data=mainvars.bal)
summary(model.twoway)
coeftest(model.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good!
fixef(model.twoway)
plmtest(model.twoway, type=c("bp"))   # Breusch-Pagan Multiplier Test; reject null of no significant differences between panels
plmtest(model.twoway, c("time"), type=("bp")) # B-P L-M test for time effects; accept that we need time effects
pbgtest(model.twoway)                         #Breusch-Godfrey/Woolridge test for serial autocorrelation, failed
data<-plm.data(modelvars, index = c("scode", "year"))
require(tseries)
adf.test(modelvars$spending.wb, k=2)                 #passes, p=0 means it is stationary
# Testing for homoskedasticity of errors
bptest(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(trade.wb):lag(mdi) +
lag(polity2) +
lag(trade.wb):lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(spending.wb) +
lag(spending.wb, 2),
data=df,
studentize=F)                #BP test for homoscedasticity, p=0 means heteroskedastic
# Two-way Fixed Effects with Democracy Interaction
model.dem.twoway<-plm(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb,2) +
lag(trade.wb):lag(mdi) +
lag(trade.wb):lag(polity2),
data=mainvars.bal,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.dem.twoway)
coeftest(model.dem.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
model.fd.twoway<-plm(diff(spending.wb) ~
lag(trade.wb) +
lag(diff(trade.wb)) +
lag(mdi) +
lag(diff(mdi)) +
lag(polity2) +
lag(diff(polity2)) +
lag(diff(gdpcap.wb)) +
lag(diff(dependency.wb)) +
lag(spending.wb) +
lag(spending.wb,3) +
lag(diff(spending.wb)) +
lag(trade.wb):lag(mdi) +
lag(diff(trade.wb)):lag(diff(mdi)) +
lag(trade.wb):lag(polity2) +
lag(diff(trade.wb)):lag(diff(polity2)),
data=mainvars.bal,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.fd.twoway)
coeftest(model.fd.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
stargazer(model.twoway, model.dem.twoway, model.fd.twoway,
title="Table 1 Re-Estimated on Balanced Panel (1961-1999)",
covariate.labels=c("$Trade_{it-1}$",
"$\\Delta Trade_{it-1}$",
"$MDI_{it-1}$",
"$\\Delta MDI_{it-1}$",
"$Democracy_{it-1}$",
"$GDPPerCapita_{it-1}$",
"$Dependency_{it-1}$",
"$LandArea_{it-1}$",
"$\\Delta Democracy_{it-1}$",
"$\\Delta GDPPerCapita_{it-1}$",
"$\\Delta Dependency_{it-1}$",
"$Spending_{it-1}$",
"$Spending_{it-2}$",
"$Spending_{it-3}$",
"$\\Delta Spending_{it-1}$",
"$Trade_{t-1}$ * $MDI_{it-1}$",
"$\\Delta Trade_{it-1}$ * $\\Delta MDI_{it-1}$",
"$Trade_{it-1}$ * $Democracy_{it-1}$",
"$\\Delta Trade_{it-1}$ * $\\Delta Democracy_{it-1}$"),
dep.var.labels.include=FALSE,
digits = 2,
style = "ajps",
omit.stat=c("f"),
font.size = "footnotesize",
out="article/balanced_models_table.tex")
#####################################################
# Reviewers suggests trying Trade*MDI at time t
###################################################
# Two-way Fixed Effects
model.twoway.nolag<-plm(spending.wb ~
trade.wb +
mdi +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb, 2) +
trade.wb:mdi,
index = c("scode","year"),
model="within",
effect="twoway",
data=mainvars)
summary(model.twoway.nolag)
coeftest(model.twoway.nolag, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
# Two-way Fixed Effects with Democracy Interaction
model.dem.twoway.nolag<-plm(spending.wb ~
trade.wb +
mdi +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb, 2) +
trade.wb:mdi +
trade.wb:polity2,
data=mainvars,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.dem.twoway.nolag)
coeftest(model.dem.twoway.nolag, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
model.fd.twoway.nolag<-plm(diff(spending.wb) ~
trade.wb +
diff(trade.wb) +
mdi +
diff(mdi) +
polity2 +
diff(polity2) +
lag(diff(gdpcap.wb)) +
lag(diff(dependency.wb)) +
lag(spending.wb) +
lag(spending.wb,3) +
lag(diff(spending.wb)) +
trade.wb:mdi +
diff(trade.wb):diff(mdi) +
trade.wb:polity2 +
diff(trade.wb):diff(polity2),
data=mainvars,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.fd.twoway.nolag)
coeftest(model.fd.twoway.nolag, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
stargazer(model.twoway.nolag, model.dem.twoway.nolag, model.fd.twoway.nolag,
title="Table 1 Re-Estimated with Trade and MDI Variables Not Lagged",
covariate.labels=c("$Trade_{it}$",
"$\\Delta Trade_{it}$",
"$MDI_{it}$",
"$Democracy_{it-1}$",
"$GDPPerCapita_{it-1}$",
"$Dependency_{it-1}$",
"$LandArea_{it-1}$",
"$\\Delta MDI_{it}$",
"$Democracy_{it}$",
"$\\Delta Democracy_{it}$",
"$\\Delta GDPPerCapita_{it-1}$",
"$\\Delta Dependency_{it-1}$",
"$Spending_{it-1}$",
"$Spending_{it-2}$",
"$Spending_{it-3}$",
"$\\Delta Spending_{it-1}$",
"$Trade_{it}$ * $MDI_{it}$",
"$\\Delta Trade_{it}$ * $\\Delta MDI_{it}$",
"$Trade_{it}$ * $Democracy_{it}$",
"$\\Delta Trade_{it}$ * $\\Delta Democracy_{it}$"),
dep.var.labels.include=FALSE,
digits = 2,
style = "ajps",
omit.stat=c("f"),
font.size = "footnotesize",
out="article/main_state_models_standardized_nolag.tex")
#############################
# Model 1 in paper ##########
############################
# Two-way Fixed Effects
model.twoway<-plm(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb, 2) +
lag(trade.wb):lag(mdi),
index = c("scode","year"),
model="within",
effect="twoway",
data=mainvars)
summary(model.twoway)
coeftest(model.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good!
fixef(model.twoway)
plmtest(model.twoway, type=c("bp"))   # Breusch-Pagan Multiplier Test; reject null of no significant differences between panels
plmtest(model.twoway, c("time"), type=("bp")) # B-P L-M test for time effects; accept that we need time effects
pbgtest(model.twoway)                         #Breusch-Godfrey/Woolridge test for serial autocorrelation, failed
data<-plm.data(modelvars, index = c("scode", "year"))
require(tseries)
adf.test(modelvars$spending.wb, k=2)                 #passes, p=0 means it is stationary
# Testing for homoskedasticity of errors
bptest(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(trade.wb):lag(mdi) +
lag(polity2) +
lag(trade.wb):lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(spending.wb) +
lag(spending.wb, 2),
data=df,
studentize=F)                #BP test for homoscedasticity, p=0 means heteroskedastic
# Two-way Fixed Effects with Democracy Interaction
model.dem.twoway<-plm(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb, 2) +
lag(trade.wb):lag(mdi) +
lag(trade.wb):lag(polity2),
data=mainvars,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.dem.twoway)
coeftest(model.dem.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good!
model.fd.twoway<-plm(diff(spending.wb) ~
lag(trade.wb) +
lag(diff(trade.wb)) +
lag(mdi) +
lag(diff(mdi)) +
lag(polity2) +
lag(diff(polity2)) +
lag(diff(gdpcap.wb)) +
lag(diff(dependency.wb)) +
lag(spending.wb) +
lag(spending.wb,3) +
lag(diff(spending.wb)) +
lag(trade.wb):lag(mdi) +
lag(diff(trade.wb)):lag(diff(mdi)) +
lag(trade.wb):lag(polity2) +
lag(diff(trade.wb)):lag(diff(polity2)),
data=mainvars,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.fd.twoway)
coeftest(model.fd.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
pbgtest(model.fd.twoway)
stargazer(model.twoway, model.dem.twoway, model.fd.twoway,
title="Determinants of Government Consumption Expenditure",
dep.var.labels.include=FALSE,
covariate.labels=c("$Trade_{it-1}$",
"$\\Delta Trade_{it-1}$",
"$MDI_{it-1}$",
"$\\Delta MDI_{it-1}$",
"$Democracy_{it-1}$",
"$GDPPerCapita_{it-1}$",
"$Dependency_{it-1}$",
"$LandArea_{it-1}$",
"$\\Delta Democracy_{it-1}$",
"$\\Delta GDPPerCapita_{it-1}$",
"$\\Delta Dependency_{it-1}$",
"$Spending_{it-1}$",
"$Spending_{it-2}$",
"$Spending_{it-3}$",
"$\\Delta Spending_{it-1}$",
"$Trade_{it-1}$ * $MDI_{it-1}$",
"$\\Delta Trade_{it-1}$ * $\\Delta MDI_{it-1}$",
"$Trade_{it-1}$ * $Democracy_{it-1}$",
"$\\Delta Trade_{it-1}$ * $\\Delta Democracy_{it-1}$"),
digits = 2,
style = "ajps",
omit.stat=c("f"),
font.size = "footnotesize",
out="article/main_state_models_standardized.tex")
