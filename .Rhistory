setwd("~/Dropbox/gh_projects/globalization_mass_media")
source('analyses/1_load.R')
source('analyses/2_clean.R')
options(scipen=999)
require(arm)
mainvars<-subset(df, select=c("scode", "year", "region", "spending.wb", "polity2", "trade.wb", "mdi", "gdpcap.wb", "dependency.wb", "land.wb"))
mainvars[,5:10]<-sapply(mainvars[,5:10], rescale)
dfextra<-subset(dfextra, select=c("scode", "year", "region", "spending.wb", "lefts", "netden", "pr", "unitarism", "polity2", "trade.wb", "mdi", "gdpcap.wb", "dependency.wb", "land.wb", "industry.wb"))
dfextra[,5:14]<-sapply(dfextra[,5:14], rescale)
modelvars<-mainvars[complete.cases(mainvars),]
require(plm)
require(lmtest)
main.comp<-mainvars[complete.cases(mainvars),]
obs.all <- tabulate(main.comp$scode) # incl lots of zeros for unused gvkey
num.obs <- tabulate(obs.all)
mode.num.obs <- which(num.obs == max(num.obs))
nt.bal <- num.obs[mode.num.obs] * mode.num.obs
pot.obs <- which(obs.all == mode.num.obs)
# create new df w/o units that don't run the whole sample period
pot.obs.index <- which(main.comp$scode %in% pot.obs)
mainvars.bal <- main.comp[pot.obs.index, ]
model.twoway<-plm(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb,2) +
lag(trade.wb):lag(mdi),
index = c("scode","year"),
model="within",
effect="twoway",
data=mainvars.bal)
summary(model.twoway)
model.dem.twoway<-plm(spending.wb ~
lag(trade.wb) +
lag(mdi) +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb,2) +
lag(trade.wb):lag(mdi) +
lag(trade.wb):lag(polity2),
data=mainvars.bal,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.dem.twoway)
model.fd.twoway<-plm(diff(spending.wb) ~
lag(trade.wb) +
lag(diff(trade.wb)) +
lag(mdi) +
lag(diff(mdi)) +
lag(polity2) +
lag(diff(polity2)) +
lag(diff(gdpcap.wb)) +
lag(diff(dependency.wb)) +
lag(spending.wb) +
lag(diff(spending.wb)) +
lag(trade.wb):lag(mdi) +
lag(diff(trade.wb)):lag(diff(mdi)) +
lag(trade.wb):lag(polity2) +
lag(diff(trade.wb)):lag(diff(polity2)),
data=mainvars.bal,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.fd.twoway)
coeftest(model.fd.twoway, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
model.twoway.nolag<-plm(spending.wb ~
trade.wb +
mdi +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb, 2) +
trade.wb:mdi,
index = c("scode","year"),
model="within",
effect="twoway",
data=mainvars)
summary(model.twoway)
summary(model.twoway.nolag)
coeftest(model.twoway.nolag, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
model.dem.twoway.nolag<-plm(spending.wb ~
trade.wb +
mdi +
lag(polity2) +
lag(gdpcap.wb) +
lag(dependency.wb) +
lag(land.wb) +
lag(spending.wb) +
lag(spending.wb, 2) +
trade.wb:mdi +
lag(trade.wb):lag(polity2),
data=mainvars,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.dem.twoway.nolag)
coeftest(model.dem.twoway.nolag, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
model.fd.twoway.nolag<-plm(diff(spending.wb) ~
trade.wb +
diff(trade.wb)) +
mdi +
diff(mdi) +
lag(polity2) +
lag(diff(polity2)) +
lag(diff(gdpcap.wb)) +
lag(diff(dependency.wb)) +
lag(spending.wb) +
lag(diff(spending.wb)) +
trade.wb:mdi +
diff(trade.wb):diff(mdi) +
lag(trade.wb):lag(polity2) +
lag(diff(trade.wb)):lag(diff(polity2)),
data=mainvars,
index = c("scode","year"),
model="within",
effect="twoway")
model.fd.twoway.nolag<-plm(diff(spending.wb) ~
trade.wb +
diff(trade.wb) +
mdi +
diff(mdi) +
lag(polity2) +
lag(diff(polity2)) +
lag(diff(gdpcap.wb)) +
lag(diff(dependency.wb)) +
lag(spending.wb) +
lag(diff(spending.wb)) +
trade.wb:mdi +
diff(trade.wb):diff(mdi) +
lag(trade.wb):lag(polity2) +
lag(diff(trade.wb)):lag(diff(polity2)),
data=mainvars,
index = c("scode","year"),
model="within",
effect="twoway")
summary(model.fd.twoway.nolag)
coeftest(model.fd.twoway.nolag, vcov=function(x) vcovBK(x, type="HC1", cluster="time"))  #looks good
stargazer(model.twoway.nolag, model.dem.twoway.nolag, model.fd.twoway.nolag,
title="Determinants of Government Consumption Expenditure",
dep.var.labels.include=FALSE,
digits = 2,
style = "ajps",
omit.stat=c("f"),
font.size = "footnotesize",
out="article/main_state_models_standardized_nolag.tex")
require(stargazer)
stargazer(model.twoway.nolag, model.dem.twoway.nolag, model.fd.twoway.nolag,
title="Determinants of Government Consumption Expenditure",
dep.var.labels.include=FALSE,
digits = 2,
style = "ajps",
omit.stat=c("f"),
font.size = "footnotesize",
out="article/main_state_models_standardized_nolag.tex")
